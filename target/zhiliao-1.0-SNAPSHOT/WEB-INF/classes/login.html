<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>登录</title>
    <link rel="stylesheet" href="../webapp/layui/css/layui.css">
    <script src="../webapp/layui/layui.js"></script>
    <script>
        layui.use(['layer','jquery','form'],function () {
            let layer=layui.layer;
            let $=layui.jquery;
            let form=layui.form;
            layer.open({
                type:1,
                title:'登录',
                area:['400px'],
                closeBtn:0,
                content:$("#login-dialog").html()
            })

            //监听登录按钮进行登录
            form.on('submit(login-submit)',function (data) {
               $.post('user/login',data.field,function (flag) {
                   console.info(flag)
                   if(flag==0||flag==-1){
                       layer.msg('你输入的用户名称或者密码有误')
                   }else if(flag==1){
                       location.href="html/user.html"
                   }
               })
                return false;//阻住提交action属性值
            })

            //监听注册按钮进行注册
            $("#btn-register").click(function (){
                //弹出修改对话框
                layer.open({
                    title:'用户注册',
                    type:1,
                    content:$("#register-dialog").html(),
                    area:['600px']
                })
                form.on('submit(register-form-submit)',function (data) {
                    $.post('user/register',data.field,function (flag) {
                        if(flag==0||flag==-1){
                            layer.msg('注册失败')
                        }else if(flag==1){
                            layer.msg('注册成功')
                            location.href="login.html"
                        }
                    })
                    return false;//阻住提交action属性值
                })
            })
        })
    </script>

    <script type="text/html" id="login-dialog">
        <form class="layui-form" >
            <div class="layui-form-item">
                <input type="text" name="username"
                       placeholder="请输入登录用户名称"  class="layui-input">
            </div>
            <div class="layui-form-item">
                <input type="text" name="password"
                       placeholder="请输入登录密码"  class="layui-input">
            </div>
            <div class="layui-form-item">
                <div class="layui-input-block">
                    <button class="layui-btn layui-btn-danger"
                            lay-submit lay-filter="login-submit">
                        <i class="layui-icon">&#xe612;</i>登录</button>
                    <button class="layui-btn layui-btn-normal" id="btn-register" >
                        <i class="layui-icon">&#xe624;</i>注册</button>
                </div>
            </div>

        </form>
    </script>

    <!--  注册对话框-->
    <script  type="text/html" id="register-dialog">
        <form  class="layui-form" id="add-form">
            <div class="layui-form-item">
                <input type="text" name="name" required  lay-verify="required"
                       placeholder="用户名" class="layui-input">
            </div>
            <div class="layui-form-item">
                <input type="text" name="password" required  lay-verify="required"
                       placeholder="密码" class="layui-input">
            </div>
            <div class="layui-form-item">
                <input type="text" name="nickname" required  lay-verify="required"
                       placeholder="昵称" class="layui-input">
            </div>
            <div class="layui-form-item">
                <input type="text" name="gander" required  lay-verify="required"
                       placeholder="性别" class="layui-input">
            </div>
            <div class="layui-form-item">
                <input type="text" name="career" required  lay-verify="required"
                       placeholder="职业" class="layui-input">
            </div>
            <div class="layui-form-item">
                <textarea name="introduction" placeholder="个性签名" class="layui-textarea"></textarea>
            </div>
            <div class="layui-form-item">
                <input type="text" name="address" required  lay-verify="required"
                       placeholder="地址" class="layui-input">
            </div>
            <div class="layui-form-item">
                <input type="text" name="email" required  lay-verify="required"
                       placeholder="邮箱" class="layui-input">
            </div>
            <div class="layui-form-item">
                <div class="layui-input-block">
                    <button class="layui-btn"  lay-submit lay-filter="register-form-submit">保存</button>
                    <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                </div>
            </div>
        </form>
    </script>


</head>
<body>

</body>
</html>